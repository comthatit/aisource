<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>í”„ë¡¬í”„íŠ¸ ì‹¤í—˜ì‹¤</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700;900&display=swap');
        body { font-family: 'Noto Sans KR', sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; }
        .fade-in { animation: fadeIn 0.5s ease-in; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        .bounce { animation: bounce 0.5s ease; }
        @keyframes bounce { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-10px); } }
        .shake { animation: shake 0.5s ease; }
        @keyframes shake { 0%, 100% { transform: translateX(0); } 25% { transform: translateX(-10px); } 75% { transform: translateX(10px); } }
        .slide-in { animation: slideIn 0.5s ease-out; }
        @keyframes slideIn { from { opacity: 0; transform: translateX(-20px); } to { opacity: 1; transform: translateX(0); } }
    </style>
</head>
<body>
    <div id="root"></div>
    <script type="text/babel">
        const { useState, useRef, useEffect } = React;
        const MAX_SCORE = 100;

        function PromptLab() {
            const [stage, setStage] = useState(0);
            const [totalScore, setTotalScore] = useState(0);
            const [completedStages, setCompletedStages] = useState({
                stage1: false, stage2: false, stage3: false, stage4: false
            });
            const [allStagesCompleted, setAllStagesCompleted] = useState(false);
            
            const updateScore = (points) => {
                setTotalScore(prev => prev + points);
            };
            
            const goToStage = (stageNum) => setStage(stageNum);

            const markStageComplete = (stageKey) => {
                setCompletedStages(prev => ({ ...prev, [stageKey]: true }));
            };

            const stages = [
                { component: IntroStage },
                { component: Stage1 },
                { component: Stage2 },
                { component: Stage3 },
                { component: Stage4 },
                { component: Stage5 }
            ];
            const CurrentComponent = stages[stage].component;

            return (
                <div className="min-h-screen py-8 px-4">
                    <div className="max-w-5xl mx-auto">
                        <div className="text-center mb-6 fade-in">
                            <h1 className="text-4xl md:text-5xl font-bold text-white mb-4">ğŸ§ª í”„ë¡¬í”„íŠ¸ ì‹¤í—˜ì‹¤</h1>
                            <p className="text-xl text-white opacity-90">AIëŠ” ì–´ë–»ê²Œ ëŒ€ë‹µí• ê¹Œ?</p>
                        </div>
                        {stage > 0 && (
                            <div className="mb-6 no-print">
                                <div className="bg-white bg-opacity-20 rounded-2xl p-4 backdrop-blur-sm mb-4">
                                    <div className="flex justify-between items-center">
                                        <div className="text-white font-bold text-lg">
                                            ğŸ† ì ìˆ˜: <span className="text-yellow-300 text-2xl">{totalScore}</span> / {MAX_SCORE}ì 
                                        </div>
                                        <div className="text-white font-bold text-lg">ğŸ“ {stage}/5 ë‹¨ê³„</div>
                                    </div>
                                </div>
                                <div className="bg-white bg-opacity-20 rounded-2xl p-4 backdrop-blur-sm">
                                    <div className="flex justify-around items-center">
                                        {['í”„ë¡¬í”„íŠ¸ ì´í•´', 'ê²°ê³¼ ë¹„êµ', 'ì°¨ì´ ë¶„ì„', 'ë¬¸ì œ í’€ì´', 'ê²°ê³¼ í™•ì¸'].map((title, idx) => {
                                            const stageNum = idx + 1;
                                            const isCurrentStage = stageNum === stage;
                                            const isCompleted = completedStages[`stage${stageNum}`] || (stageNum === 5 && allStagesCompleted);
                                            const canAccess = stageNum <= stage || allStagesCompleted;
                                            
                                            return (
                                                <button key={idx} onClick={() => goToStage(stageNum)}
                                                    disabled={!canAccess}
                                                    className={`flex flex-col items-center px-2 py-2 rounded-xl transition-all duration-300 ${
                                                        isCurrentStage ? 'bg-purple-500 text-white scale-110'
                                                        : isCompleted ? 'bg-lime-400 text-white hover:scale-105'
                                                        : 'bg-white bg-opacity-30 text-white opacity-50 cursor-not-allowed'
                                                    }`}>
                                                    <div className="text-lg mb-1">
                                                        {isCompleted ? 'âœ“' : isCurrentStage ? 'â–¶' : stageNum}
                                                    </div>
                                                    <div className="text-xs font-bold">{title}</div>
                                                </button>
                                            );
                                        })}
                                    </div>
                                </div>
                            </div>
                        )}
                        <CurrentComponent
                            goToStage={goToStage} 
                            updateScore={updateScore} 
                            totalScore={totalScore}
                            markStageComplete={markStageComplete}
                            setAllStagesCompleted={setAllStagesCompleted}
                        />
                    </div>
                </div>
            );
        }

        function IntroStage({ goToStage }) {
            return (
                <div className="bg-white rounded-3xl shadow-2xl p-8 md:p-12 fade-in">
                    <div className="text-center mb-8">
                        <div className="text-6xl mb-6 bounce">ğŸ”¬</div>
                        <h2 className="text-3xl font-bold text-gray-800 mb-4">í”„ë¡¬í”„íŠ¸ ì‹¤í—˜ì‹¤ì— ì˜¤ì‹  ê²ƒì„ í™˜ì˜í•©ë‹ˆë‹¤!</h2>
                        <p className="text-lg text-gray-600 leading-relaxed mb-6">
                            AIì—ê²Œ ì–´ë–»ê²Œ ì§ˆë¬¸í•˜ëŠëƒì— ë”°ë¼<br/>ë‹µë³€ì´ ì™„ì „íˆ ë‹¬ë¼ì§„ë‹¤ëŠ” ì‚¬ì‹¤, ì•Œê³  ê³„ì…¨ë‚˜ìš”?
                        </p>
                    </div>

                    <div className="bg-gradient-to-br from-blue-50 to-cyan-50 rounded-2xl p-6 mb-8 border-2 border-blue-200">
                        <h3 className="text-xl font-bold text-blue-800 mb-4">ğŸ¯ í•™ìŠµ ëª©í‘œ</h3>
                        <div className="space-y-3 text-left">
                            <div className="flex items-start">
                                <span className="text-2xl mr-3">ğŸ’¡</span>
                                <p className="text-gray-700 flex-1"><span className="font-bold">í”„ë¡¬í”„íŠ¸ì˜ ê°œë…</span>ì„ ì´í•´í•˜ê³  ì„¤ëª…í•  ìˆ˜ ìˆë‹¤</p>
                            </div>
                            <div className="flex items-start">
                                <span className="text-2xl mr-3">ğŸ”</span>
                                <p className="text-gray-700 flex-1"><span className="font-bold">ëª…ë ¹ë¬¸ì˜ ì°¨ì´</span>ê°€ ê²°ê³¼ì— ë¯¸ì¹˜ëŠ” ì˜í–¥ì„ ë¶„ì„í•  ìˆ˜ ìˆë‹¤</p>
                            </div>
                            <div className="flex items-start">
                                <span className="text-2xl mr-3">âœ¨</span>
                                <p className="text-gray-700 flex-1"><span className="font-bold">ì¢‹ì€ í”„ë¡¬í”„íŠ¸ì˜ ì¡°ê±´</span>ì„ íŒŒì•…í•  ìˆ˜ ìˆë‹¤</p>
                            </div>
                        </div>
                    </div>

                    <div className="bg-gradient-to-r from-purple-50 to-pink-50 rounded-2xl p-6 mb-8 border-2 border-purple-200">
                        <h3 className="text-xl font-bold text-purple-800 mb-4">ğŸ—ºï¸ í•™ìŠµ ì—¬ì •</h3>
                        <div className="grid md:grid-cols-5 gap-3">
                            {[
                                { icon: 'ğŸ“', title: '1ë‹¨ê³„', desc: 'í”„ë¡¬í”„íŠ¸ë€?' },
                                { icon: 'ğŸ”„', title: '2ë‹¨ê³„', desc: 'ê²°ê³¼ ë¹„êµí•˜ê¸°' },
                                { icon: 'ğŸ§ ', title: '3ë‹¨ê³„', desc: 'ì°¨ì´ ë¶„ì„í•˜ê¸°' },
                                { icon: 'âœï¸', title: '4ë‹¨ê³„', desc: 'ë¬¸ì œ í’€ì´' },
                                { icon: 'ğŸ“', title: '5ë‹¨ê³„', desc: 'ê²°ê³¼ í™•ì¸' }
                            ].map((step, idx) => (
                                <div key={idx} className="bg-white rounded-xl p-3 text-center">
                                    <div className="text-2xl mb-1">{step.icon}</div>
                                    <div className="font-bold text-gray-800 text-xs mb-1">{step.title}</div>
                                    <div className="text-xs text-gray-600">{step.desc}</div>
                                </div>
                            ))}
                        </div>
                    </div>

                    <button onClick={() => goToStage(1)}
                        className="w-full bg-gradient-to-r from-blue-600 to-purple-600 text-white text-xl font-bold py-5 px-8 rounded-2xl hover:shadow-2xl transform hover:scale-105 transition-all">
                        ğŸš€ ì‹¤í—˜ ì‹œì‘í•˜ê¸°
                    </button>
                </div>
            );
        }

        function Stage1({ goToStage, markStageComplete }) {
            const [currentQuestion, setCurrentQuestion] = useState(0);
            const [showContent, setShowContent] = useState(true);

            const contents = [
                {
                    id: 'c1',
                    title: 'í”„ë¡¬í”„íŠ¸(Prompt)ë€?',
                    emoji: 'ğŸ’¬',
                    explanation: 'AIì—ê²Œ ì£¼ëŠ” ëª…ë ¹ë¬¸ì´ë‚˜ ì§ˆë¬¸ì„ "í”„ë¡¬í”„íŠ¸"ë¼ê³  í•©ë‹ˆë‹¤. ë§ˆì¹˜ ìš”ë¦¬ì‚¬ì—ê²Œ ìš”ë¦¬ë²•ì„ ì„¤ëª…í•˜ëŠ” ê²ƒì²˜ëŸ¼, AIì—ê²Œ ë¬´ì—‡ì„ ì–´ë–»ê²Œ í•´ë‹¬ë¼ê³  ìš”ì²­í•˜ëŠ” ê²ƒì´ í”„ë¡¬í”„íŠ¸ì˜ˆìš”.',
                    examples: [
                        '"ê³ ì–‘ì´ë¥¼ ê·¸ë ¤ì¤˜"',
                        '"ì—¬í–‰ ê³„íšì„ ì„¸ì›Œì¤˜"',
                        '"íŒŒì´ì¬ ì½”ë“œë¥¼ ì‘ì„±í•´ì¤˜"'
                    ]
                },
                {
                    id: 'c2',
                    title: 'í”„ë¡¬í”„íŠ¸ì˜ ì¤‘ìš”ì„±',
                    emoji: 'â­',
                    explanation: 'ê°™ì€ AIë¼ë„ í”„ë¡¬í”„íŠ¸ê°€ ë‹¤ë¥´ë©´ ì™„ì „íˆ ë‹¤ë¥¸ ê²°ê³¼ë¥¼ ë§Œë“¤ì–´ëƒ…ë‹ˆë‹¤. í”„ë¡¬í”„íŠ¸ëŠ” AIì™€ ëŒ€í™”í•˜ëŠ” ì–¸ì–´ì´ì, ì›í•˜ëŠ” ê²°ê³¼ë¥¼ ì–»ëŠ” ì—´ì‡ ì˜ˆìš”.',
                    keyPoint: 'í”„ë¡¬í”„íŠ¸ = AIì˜ ì…ë ¥ / AI ë‹µë³€ = ì¶œë ¥'
                },
                {
                    id: 'c3',
                    title: 'ì¢‹ì€ í”„ë¡¬í”„íŠ¸ì˜ ì²«ê±¸ìŒ',
                    emoji: 'ğŸ¯',
                    explanation: 'ì¢‹ì€ í”„ë¡¬í”„íŠ¸ëŠ” ëª…í™•í•˜ê³  êµ¬ì²´ì ì…ë‹ˆë‹¤. "ê·¸ë¦¼ ê·¸ë ¤ì¤˜"ë³´ë‹¤ëŠ” "í•´ë³€ì—ì„œ ì¼ëª°ì„ ë³´ëŠ” ê³ ì–‘ì´ë¥¼ ê·¸ë ¤ì¤˜"ê°€ í›¨ì”¬ ì¢‹ì€ í”„ë¡¬í”„íŠ¸ì˜ˆìš”.',
                    comparison: {
                        bad: 'âŒ ëª¨í˜¸í•œ í”„ë¡¬í”„íŠ¸: "ìŒì‹ ì¶”ì²œí•´ì¤˜"',
                        good: 'âœ… ì¢‹ì€ í”„ë¡¬í”„íŠ¸: "ë§¤ìš´ ìŒì‹ì„ ì¢‹ì•„í•˜ëŠ” ì‚¬ëŒì„ ìœ„í•œ í•œì‹ ì¶”ì²œí•´ì¤˜"'
                    }
                }
            ];

            const currentContent = contents[currentQuestion];

            const handleNext = () => {
                if (currentQuestion < contents.length - 1) {
                    setCurrentQuestion(currentQuestion + 1);
                } else {
                    markStageComplete('stage1');
                    goToStage(2);
                }
            };

            return (
                <div className="bg-white rounded-3xl shadow-2xl p-8 md:p-12 fade-in">
                    <div className="text-center mb-8">
                        <div className="text-6xl mb-6 bounce">{currentContent.emoji}</div>
                        <h2 className="text-3xl font-bold text-gray-800 mb-4">1ë‹¨ê³„: í”„ë¡¬í”„íŠ¸ë€ ë¬´ì—‡ì¼ê¹Œ?</h2>
                        <div className="flex justify-center gap-2 mb-4">
                            {contents.map((_, idx) => (
                                <div key={idx} className={`w-3 h-3 rounded-full ${idx === currentQuestion ? 'bg-blue-500' : idx < currentQuestion ? 'bg-green-500' : 'bg-gray-300'}`} />
                            ))}
                        </div>
                        <p className="text-gray-600">{currentQuestion + 1} / {contents.length}</p>
                    </div>

                    <div className="bg-gradient-to-br from-blue-50 to-purple-50 rounded-2xl p-8 mb-8 border-2 border-blue-200">
                        <h3 className="text-2xl font-bold text-blue-800 mb-6 text-center">{currentContent.title}</h3>
                        
                        <div className="bg-white rounded-xl p-6 mb-6">
                            <p className="text-gray-800 text-lg leading-relaxed">{currentContent.explanation}</p>
                        </div>

                        {currentContent.examples && (
                            <div className="bg-gradient-to-r from-purple-50 to-pink-50 rounded-xl p-5 mb-4">
                                <p className="font-bold text-purple-800 mb-3">ğŸ“ í”„ë¡¬í”„íŠ¸ ì˜ˆì‹œ:</p>
                                <div className="space-y-2">
                                    {currentContent.examples.map((ex, idx) => (
                                        <div key={idx} className="bg-white rounded-lg p-3 border-l-4 border-purple-500">
                                            <p className="text-gray-700">{ex}</p>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        )}

                        {currentContent.keyPoint && (
                            <div className="bg-yellow-50 rounded-xl p-5 border-2 border-yellow-300">
                                <p className="text-yellow-900 font-bold text-center text-lg">ğŸ’¡ {currentContent.keyPoint}</p>
                            </div>
                        )}

                        {currentContent.comparison && (
                            <div className="space-y-3">
                                <div className="bg-red-50 rounded-xl p-4 border-l-4 border-red-400">
                                    <p className="text-gray-800">{currentContent.comparison.bad}</p>
                                </div>
                                <div className="bg-green-50 rounded-xl p-4 border-l-4 border-green-400">
                                    <p className="text-gray-800">{currentContent.comparison.good}</p>
                                </div>
                            </div>
                        )}
                    </div>

                    <button onClick={handleNext}
                        className="w-full bg-gradient-to-r from-blue-600 to-purple-600 text-white text-xl font-bold py-5 px-8 rounded-2xl hover:shadow-2xl transform hover:scale-105 transition-all">
                        {currentQuestion < contents.length - 1 ? 'ë‹¤ìŒ âœ' : '2ë‹¨ê³„ë¡œ ì´ë™ âœ'}
                    </button>
                </div>
            );
        }

        function Stage2({ goToStage, markStageComplete }) {
            const [currentComparison, setCurrentComparison] = useState(0);
            const [selectedPrompt, setSelectedPrompt] = useState(null);
            const [showResult, setShowResult] = useState(false);

            const comparisons = [
                {
                    id: 'c1',
                    topic: 'ê³ ì–‘ì´ ì„¤ëª…í•˜ê¸°',
                    prompts: [
                        {
                            id: 'cute',
                            text: 'ê³ ì–‘ì´ë¥¼ ê·€ì—½ê²Œ ì„¤ëª…í•´ì¤˜',
                            style: 'ê°ì„±ì ',
                            result: 'ê³ ì–‘ì´ëŠ” ë³´ë“¤ë³´ë“¤í•œ í„¸ì„ ê°€ì§„ ì‚¬ë‘ìŠ¤ëŸ¬ìš´ ì¹œêµ¬ì˜ˆìš”! ğŸ± ë™ê·¸ë€ ëˆˆë§ìš¸ë¡œ ìš°ë¦¬ë¥¼ ë°”ë¼ë³´ë©° ì•¼ì˜¹~ í•˜ê³  ìš¸ì–´ìš”. ì‘ì€ ë°œë°”ë‹¥ìœ¼ë¡œ ì´ì´ ê±¸ì–´ë‹¤ë‹ˆëŠ” ëª¨ìŠµì´ ì •ë§ ê·€ì—¬ì›Œìš”. ìš°ë¦¬ê°€ ì“°ë‹¤ë“¬ì–´ì£¼ë©´ ê°€ë¥´ë¦‰ ì†Œë¦¬ë¥¼ ë‚´ë©° ì¢‹ì•„í•œë‹µë‹ˆë‹¤!'
                        },
                        {
                            id: 'scientific',
                            text: 'ê³ ì–‘ì´ë¥¼ ê³¼í•™ì ìœ¼ë¡œ ì„¤ëª…í•´ì¤˜',
                            style: 'ê³¼í•™ì ',
                            result: 'ê³ ì–‘ì´(Felis catus)ëŠ” í¬ìœ ë¥˜ ê³ ì–‘ì´ê³¼ì— ì†í•˜ëŠ” ìœ¡ì‹ë™ë¬¼ì…ë‹ˆë‹¤. í‰ê·  ì²´ì¤‘ì€ 4-5kgì´ë©°, ì²™ì¶”ë™ë¬¼ë¡œì„œ ë›°ì–´ë‚œ ì•¼ê°„ ì‹œë ¥ì„ ê°€ì§€ê³  ìˆìŠµë‹ˆë‹¤. ì²­ê° ë²”ìœ„ëŠ” 48Hz~85kHzë¡œ ì¸ê°„ë³´ë‹¤ ë„“ìœ¼ë©°, ë°œí†±ì„ ììœ ë¡­ê²Œ ìˆ˜ì¶•í•  ìˆ˜ ìˆëŠ” ì‹ ì¶•ì„± ë°œí†±ì„ ê°€ì§€ê³  ìˆìŠµë‹ˆë‹¤.'
                        }
                    ],
                    explanation: 'AIëŠ” "ê·€ì—½ê²Œ"ë¼ëŠ” ë‹¨ì„œì—ì„œ ê°ì„±ì  í‘œí˜„ì„, "ê³¼í•™ì ìœ¼ë¡œ"ë¼ëŠ” ë‹¨ì„œì—ì„œ ê°ê´€ì  ì •ë³´ë¥¼ ì œê³µí–ˆì–´ìš”!'
                },
                {
                    id: 'c2',
                    topic: 'ì—¬í–‰ ê³„íš ì„¸ìš°ê¸°',
                    prompts: [
                        {
                            id: 'simple',
                            text: 'ì œì£¼ë„ ì—¬í–‰ ê³„íš ì„¸ì›Œì¤˜',
                            style: 'ê°„ë‹¨í•œ',
                            result: 'ì œì£¼ë„ ì—¬í–‰ ê³„íš:\n\n1ì¼ì°¨: ê³µí•­ ë„ì°© â†’ í˜¸í…” ì²´í¬ì¸ â†’ í•´ë³€ ì‚°ì±…\n2ì¼ì°¨: í•œë¼ì‚° ë“±ë°˜ â†’ ì„±ì‚°ì¼ì¶œë´‰\n3ì¼ì°¨: ì¹´í˜ íˆ¬ì–´ â†’ ê·€ê°€\n\nì¶”ì²œ ìŒì‹: í‘ë¼ì§€, í•´ì‚°ë¬¼'
                        },
                        {
                            id: 'detailed',
                            text: 'ì œì£¼ë„ 2ë°•3ì¼ ì—¬í–‰ ê³„íšì„ ì„¸ì›Œì¤˜. ë§›ì§‘ê³¼ í¬í† ì¡´ ìœ„ì£¼ë¡œ ì¶”ì²œí•´ì¤˜',
                            style: 'êµ¬ì²´ì ',
                            result: 'ğŸ“¸ ì œì£¼ë„ 2ë°•3ì¼ ë§›ì§‘&í¬í† ì¡´ ì—¬í–‰ ê³„íš\n\nğŸ—“ 1ì¼ì°¨\nâ€¢ 09:00 - ì œì£¼ê³µí•­ ë„ì°©\nâ€¢ 10:30 - ì• ì›” ì¹´í˜ê±°ë¦¬ (í¬í† ì¡´: ë°”ë‹¤ë·° ì¹´í˜)\nâ€¢ 12:00 - ê³ ê¸°êµ­ìˆ˜ ë§›ì§‘ "ì˜¬ë ˆêµ­ìˆ˜"\nâ€¢ 14:00 - í˜‘ì¬í•´ìˆ˜ìš•ì¥ (ì—ë©”ë„ë“œë¹› ë°”ë‹¤)\nâ€¢ 18:00 - í‘ë¼ì§€ ë§›ì§‘ "ëˆì‚¬ëˆ"\n\nğŸ—“ 2ì¼ì°¨\nâ€¢ 08:00 - ì„±ì‚°ì¼ì¶œë´‰ ì¼ì¶œ (ì¸ìƒìƒ· ëª…ì†Œ)\nâ€¢ 10:00 - í•´ë…€ì˜ ì§‘ í•´ì‚°ë¬¼\nâ€¢ 13:00 - ì„­ì§€ì½”ì§€ (ë“œë¼ë§ˆ ì´¬ì˜ì§€)\nâ€¢ 16:00 - ì›”ì •ë¦¬ ì¹´í˜ê±°ë¦¬\nâ€¢ 19:00 - ì œì£¼ ì‹œë‚´ í‘ë¼ì§€ ê±°ë¦¬\n\nğŸ—“ 3ì¼ì°¨\nâ€¢ 09:00 - ìš°ë„ ë‹¹ì¼ì¹˜ê¸°\nâ€¢ 12:00 - ìš°ë„ ë•…ì½©ì•„ì´ìŠ¤í¬ë¦¼\nâ€¢ 15:00 - ê³µí•­ ì¶œë°œ\n\nğŸ’¡ TIP: ë Œí„°ì¹´ í•„ìˆ˜, ì¼ëª° ì‹œê°„ í™•ì¸!'
                        }
                    ],
                    explanation: 'êµ¬ì²´ì ì¸ ì¡°ê±´(2ë°•3ì¼, ë§›ì§‘, í¬í† ì¡´)ì„ ëª…ì‹œí•˜ì AIê°€ ë” ìƒì„¸í•˜ê³  ë§ì¶¤í™”ëœ ë‹µë³€ì„ ì œê³µí–ˆì–´ìš”!'
                }
            ];

            const currentComp = comparisons[currentComparison];

            const handlePromptClick = (promptId) => {
                if (showResult) return;
                setSelectedPrompt(promptId);
            };

            const handleCompare = () => {
                if (!selectedPrompt) return;
                setShowResult(true);
            };

            const handleNext = () => {
                if (currentComparison < comparisons.length - 1) {
                    setCurrentComparison(currentComparison + 1);
                    setSelectedPrompt(null);
                    setShowResult(false);
                } else {
                    markStageComplete('stage2');
                    goToStage(3);
                }
            };

            return (
                <div className="bg-white rounded-3xl shadow-2xl p-8 md:p-12 fade-in">
                    <div className="text-center mb-8">
                        <div className="text-6xl mb-6 bounce">ğŸ”„</div>
                        <h2 className="text-3xl font-bold text-gray-800 mb-4">2ë‹¨ê³„: ì„œë¡œ ë‹¤ë¥¸ í”„ë¡¬í”„íŠ¸ ë¹„êµí•˜ê¸°</h2>
                        <div className="flex justify-center gap-2 mb-4">
                            {comparisons.map((_, idx) => (
                                <div key={idx} className={`w-3 h-3 rounded-full ${idx === currentComparison ? 'bg-purple-500' : idx < currentComparison ? 'bg-green-500' : 'bg-gray-300'}`} />
                            ))}
                        </div>
                        <p className="text-gray-600">ë¹„êµ {currentComparison + 1} / {comparisons.length}</p>
                    </div>

                    <div className="bg-gradient-to-br from-purple-50 to-pink-50 rounded-2xl p-6 mb-6 border-2 border-purple-200">
                        <h3 className="text-xl font-bold text-purple-800 mb-6">ğŸ¯ ì£¼ì œ: {currentComp.topic}</h3>
                        
                        <div className="grid md:grid-cols-2 gap-6 mb-6">
                            {currentComp.prompts.map((prompt, idx) => (
                                <div key={prompt.id} 
                                    onClick={() => handlePromptClick(prompt.id)}
                                    className={`cursor-pointer transition-all duration-300 ${
                                        selectedPrompt === prompt.id ? 'scale-105' : 'hover:scale-102'
                                    }`}>
                                    <div className={`bg-white rounded-xl p-5 border-2 ${
                                        selectedPrompt === prompt.id ? 'border-purple-500 shadow-lg' : 'border-gray-300'
                                    }`}>
                                        <div className="flex items-center justify-between mb-3">
                                            <span className="text-2xl font-bold text-gray-400">í”„ë¡¬í”„íŠ¸ {idx + 1}</span>
                                            <span className={`px-3 py-1 rounded-full text-xs font-bold ${
                                                idx === 0 ? 'bg-blue-100 text-blue-700' : 'bg-green-100 text-green-700'
                                            }`}>{prompt.style}</span>
                                        </div>
                                        <div className="bg-gray-50 rounded-lg p-4 mb-3 border-l-4 border-purple-500">
                                            <p className="text-gray-800 font-medium">"{prompt.text}"</p>
                                        </div>
                                        {showResult && (
                                            <div className="bg-blue-50 rounded-lg p-4 border-2 border-blue-200 slide-in">
                                                <div className="text-sm font-bold text-blue-800 mb-2">âœ¨ AI ë‹µë³€:</div>
                                                <p className="text-gray-700 text-sm whitespace-pre-line leading-relaxed">{prompt.result}</p>
                                            </div>
                                        )}
                                    </div>
                                </div>
                            ))}
                        </div>

                        {!showResult ? (
                            <button 
                                onClick={handleCompare}
                                disabled={!selectedPrompt}
                                className={`w-full py-4 px-6 rounded-xl text-lg font-bold transition-all ${
                                    selectedPrompt 
                                        ? 'bg-gradient-to-r from-purple-600 to-pink-600 text-white hover:shadow-lg transform hover:scale-105' 
                                        : 'bg-gray-300 text-gray-500 cursor-not-allowed'
                                }`}>
                                {selectedPrompt ? 'ğŸ” ê²°ê³¼ ë¹„êµí•˜ê¸°' : 'â¬†ï¸ í”„ë¡¬í”„íŠ¸ë¥¼ ë¨¼ì € ì„ íƒí•˜ì„¸ìš”'}
                            </button>
                        ) : (
                            <div className="space-y-6 fade-in">
                                <div className="bg-gradient-to-br from-blue-50 to-cyan-50 rounded-2xl p-6 border-2 border-blue-300">
                                    <div className="flex items-start">
                                        <span className="text-3xl mr-4">ğŸ’¡</span>
                                        <div className="flex-1">
                                            <h4 className="text-xl font-bold text-blue-800 mb-3">ì°¨ì´ê°€ ë°œìƒí•œ ì´ìœ </h4>
                                            <p className="text-gray-700 text-lg leading-relaxed">{currentComp.explanation}</p>
                                        </div>
                                    </div>
                                </div>

                                <button onClick={handleNext}
                                    className="w-full bg-gradient-to-r from-blue-600 to-purple-600 text-white text-xl font-bold py-5 px-8 rounded-2xl hover:shadow-2xl transform hover:scale-105 transition-all">
                                    {currentComparison < comparisons.length - 1 ? 'ë‹¤ìŒ ë¹„êµ âœ' : '3ë‹¨ê³„ë¡œ ì´ë™ âœ'}
                                </button>
                            </div>
                        )}
                    </div>
                </div>
            );
        }

        function Stage3({ goToStage, markStageComplete }) {
            const [currentExample, setCurrentExample] = useState(0);

            const examples = [
                {
                    id: 'ex1',
                    title: 'ëª…í™•ì„±ì˜ ì¤‘ìš”ì„±',
                    emoji: 'ğŸ¯',
                    before: 'ìš”ë¦¬ë²• ì•Œë ¤ì¤˜',
                    after: 'ì´ˆë³´ìë„ 30ë¶„ ì•ˆì— ë§Œë“¤ ìˆ˜ ìˆëŠ” ê°„ë‹¨í•œ í† ë§ˆí†  íŒŒìŠ¤íƒ€ ë ˆì‹œí”¼ë¥¼ ì•Œë ¤ì¤˜',
                    keyPoints: [
                        'ëŒ€ìƒ ëª…ì‹œ: "ì´ˆë³´ìë„"',
                        'ì‹œê°„ ì¡°ê±´: "30ë¶„ ì•ˆì—"',
                        'ë‚œì´ë„: "ê°„ë‹¨í•œ"',
                        'êµ¬ì²´ì  ìŒì‹: "í† ë§ˆí†  íŒŒìŠ¤íƒ€"'
                    ],
                    conclusion: 'ëª¨í˜¸í•œ ìš”ì²­ë³´ë‹¤ ëª…í™•í•œ ì¡°ê±´ì„ ì œì‹œí•˜ë©´ ì›í•˜ëŠ” ë‹µë³€ì„ ì–»ì„ ìˆ˜ ìˆì–´ìš”!'
                },
                {
                    id: 'ex2',
                    title: 'êµ¬ì²´ì„±ì˜ í˜',
                    emoji: 'âœ¨',
                    before: 'ê·¸ë¦¼ ê·¸ë ¤ì¤˜',
                    after: 'í•´ë³€ì—ì„œ ì¼ëª°ì„ ê°ìƒí•˜ëŠ” ê³ ì–‘ì´ë¥¼ ìˆ˜ì±„í™” í’ìœ¼ë¡œ ê·¸ë ¤ì¤˜',
                    keyPoints: [
                        'ì¥ì†Œ: "í•´ë³€"',
                        'ìƒí™©: "ì¼ëª°ì„ ê°ìƒí•˜ëŠ”"',
                        'ëŒ€ìƒ: "ê³ ì–‘ì´"',
                        'ìŠ¤íƒ€ì¼: "ìˆ˜ì±„í™” í’"'
                    ],
                    conclusion: 'ì„¸ë¶€ ì‚¬í•­ì„ êµ¬ì²´ì ìœ¼ë¡œ ëª…ì‹œí• ìˆ˜ë¡ ë” ì •í™•í•œ ê²°ê³¼ë¥¼ ì–»ì„ ìˆ˜ ìˆì–´ìš”!'
                },
                {
                    id: 'ex3',
                    title: 'ë‹¨ê³„ì  ì§€ì‹œ',
                    emoji: 'ğŸ“‹',
                    before: 'í”„ë¡œê·¸ë¨ ë§Œë“¤ì–´ì¤˜',
                    after: 'Pythonìœ¼ë¡œ ì‚¬ì¹™ì—°ì‚° ê³„ì‚°ê¸°ë¥¼ ë§Œë“¤ì–´ì¤˜. 1) í•¨ìˆ˜ë¡œ êµ¬í˜„ 2) ê° í•¨ìˆ˜ì— ì£¼ì„ ì¶”ê°€ 3) ì‚¬ìš© ì˜ˆì‹œ í¬í•¨',
                    keyPoints: [
                        'ì–¸ì–´ ì§€ì •: "Python"',
                        'ê¸°ëŠ¥ ëª…ì‹œ: "ì‚¬ì¹™ì—°ì‚° ê³„ì‚°ê¸°"',
                        'êµ¬ì¡° ìš”ì²­: "í•¨ìˆ˜ë¡œ êµ¬í˜„"',
                        'ì¶”ê°€ ìš”êµ¬ì‚¬í•­: "ì£¼ì„", "ì˜ˆì‹œ"'
                    ],
                    conclusion: 'ë³µì¡í•œ ìš”ì²­ì€ ë‹¨ê³„ë¥¼ ë‚˜ëˆ„ì–´ ëª…í™•í•˜ê²Œ ì§€ì‹œí•˜ë©´ ë” ì²´ê³„ì ì¸ ê²°ê³¼ë¥¼ ì–»ì–´ìš”!'
                }
            ];

            const currentEx = examples[currentExample];

            const handleNext = () => {
                if (currentExample < examples.length - 1) {
                    setCurrentExample(currentExample + 1);
                } else {
                    markStageComplete('stage3');
                    goToStage(4);
                }
            };

            return (
                <div className="bg-white rounded-3xl shadow-2xl p-8 md:p-12 fade-in">
                    <div className="text-center mb-8">
                        <div className="text-6xl mb-6 bounce">{currentEx.emoji}</div>
                        <h2 className="text-3xl font-bold text-gray-800 mb-4">3ë‹¨ê³„: ì°¨ì´ë¥¼ ë§Œë“œëŠ” ì´ìœ  ë¶„ì„í•˜ê¸°</h2>
                        <div className="flex justify-center gap-2 mb-4">
                            {examples.map((_, idx) => (
                                <div key={idx} className={`w-3 h-3 rounded-full ${idx === currentExample ? 'bg-purple-500' : idx < currentExample ? 'bg-green-500' : 'bg-gray-300'}`} />
                            ))}
                        </div>
                        <p className="text-gray-600">{currentExample + 1} / {examples.length}</p>
                    </div>

                    <div className="bg-gradient-to-br from-purple-50 to-pink-50 rounded-2xl p-6 mb-6 border-2 border-purple-200">
                        <h3 className="text-2xl font-bold text-purple-800 mb-8 text-center">{currentEx.title}</h3>

                        <div className="space-y-6 mb-8">
                            <div className="bg-red-50 rounded-xl p-6 border-2 border-red-300">
                                <div className="flex items-center mb-3">
                                    <span className="text-2xl mr-3">âŒ</span>
                                    <h4 className="font-bold text-red-800 text-lg">ê°œì„  ì „</h4>
                                </div>
                                <div className="bg-white rounded-lg p-4">
                                    <p className="text-gray-800 font-medium text-lg">"{currentEx.before}"</p>
                                </div>
                            </div>

                            <div className="flex justify-center">
                                <div className="text-4xl">â¬‡ï¸</div>
                            </div>

                            <div className="bg-green-50 rounded-xl p-6 border-2 border-green-300">
                                <div className="flex items-center mb-3">
                                    <span className="text-2xl mr-3">âœ…</span>
                                    <h4 className="font-bold text-green-800 text-lg">ê°œì„  í›„</h4>
                                </div>
                                <div className="bg-white rounded-lg p-4">
                                    <p className="text-gray-800 font-medium text-lg">"{currentEx.after}"</p>
                                </div>
                            </div>
                        </div>

                        <div className="bg-blue-50 rounded-xl p-6 border-2 border-blue-300 mb-6">
                            <h4 className="font-bold text-blue-800 mb-4 text-lg">ğŸ” ê°œì„  í¬ì¸íŠ¸</h4>
                            <div className="space-y-2">
                                {currentEx.keyPoints.map((point, idx) => (
                                    <div key={idx} className="flex items-start bg-white rounded-lg p-3">
                                        <span className="text-blue-600 mr-3 font-bold">{idx + 1}.</span>
                                        <span className="text-gray-700">{point}</span>
                                    </div>
                                ))}
                            </div>
                        </div>

                        <div className="bg-gradient-to-r from-yellow-50 to-amber-50 rounded-xl p-6 border-2 border-yellow-300">
                            <div className="flex items-start">
                                <span className="text-3xl mr-4">ğŸ’¡</span>
                                <div className="flex-1">
                                    <p className="text-gray-800 font-bold text-lg">{currentEx.conclusion}</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <button onClick={handleNext}
                        className="w-full bg-gradient-to-r from-purple-600 to-pink-600 text-white text-xl font-bold py-5 px-8 rounded-2xl hover:shadow-2xl transform hover:scale-105 transition-all">
                        {currentExample < examples.length - 1 ? 'ë‹¤ìŒ ì˜ˆì‹œ âœ' : '4ë‹¨ê³„ë¡œ ì´ë™ âœ'}
                    </button>
                </div>
            );
        }

        function Stage4({ goToStage, updateScore, markStageComplete }) {
            const [currentQuestion, setCurrentQuestion] = useState(0);
            const [selectedAnswer, setSelectedAnswer] = useState(null);
            const [showFeedback, setShowFeedback] = useState(false);
            const [earnedScore, setEarnedScore] = useState(0);

            const questions = [
                {
                    id: 'q1',
                    question: 'í”„ë¡¬í”„íŠ¸(Prompt)ì— ëŒ€í•œ ì„¤ëª…ìœ¼ë¡œ ì˜¬ë°”ë¥¸ ê²ƒì€?',
                    options: [
                        { id: 'a', text: 'AIê°€ í•™ìŠµí•˜ëŠ” ë°ì´í„°ë¥¼ ì˜ë¯¸í•œë‹¤', correct: false },
                        { id: 'b', text: 'AIì—ê²Œ ì£¼ëŠ” ëª…ë ¹ë¬¸ì´ë‚˜ ì§ˆë¬¸ì´ë‹¤', correct: true },
                        { id: 'c', text: 'AIì˜ ì²˜ë¦¬ ì†ë„ë¥¼ ê²°ì •í•˜ëŠ” ìš”ì†Œë‹¤', correct: false },
                        { id: 'd', text: 'AIê°€ ìƒì„±í•œ ìµœì¢… ê²°ê³¼ë¬¼ì´ë‹¤', correct: false }
                    ],
                    explanation: 'í”„ë¡¬í”„íŠ¸ëŠ” AIì—ê²Œ ì£¼ëŠ” ëª…ë ¹ë¬¸ì´ë‚˜ ì§ˆë¬¸ì…ë‹ˆë‹¤. ìš°ë¦¬ê°€ AIì—ê²Œ ë¬´ì—‡ì„ ìš”ì²­í•˜ëŠ”ì§€ ì•Œë ¤ì£¼ëŠ” ì…ë ¥ê°’ì´ì—ìš”!',
                    points: 20
                },
                {
                    id: 'q2',
                    question: 'ë‹¤ìŒ ì¤‘ ë” ì¢‹ì€ í”„ë¡¬í”„íŠ¸ëŠ”?',
                    options: [
                        { id: 'a', text: 'ìš”ë¦¬ ì•Œë ¤ì¤˜', correct: false },
                        { id: 'b', text: 'ì´ˆë³´ìë„ 30ë¶„ ì•ˆì— ë§Œë“¤ ìˆ˜ ìˆëŠ” ê°„ë‹¨í•œ íŒŒìŠ¤íƒ€ ë ˆì‹œí”¼ ì•Œë ¤ì¤˜', correct: true },
                        { id: 'c', text: 'íŒŒìŠ¤íƒ€', correct: false },
                        { id: 'd', text: 'ë§›ìˆëŠ” ê±° ì•Œë ¤ì¤˜', correct: false }
                    ],
                    explanation: 'ì¢‹ì€ í”„ë¡¬í”„íŠ¸ëŠ” ëŒ€ìƒ(ì´ˆë³´ì), ì‹œê°„(30ë¶„), ë‚œì´ë„(ê°„ë‹¨í•œ), ìŒì‹ ì¢…ë¥˜(íŒŒìŠ¤íƒ€)ë¥¼ êµ¬ì²´ì ìœ¼ë¡œ ëª…ì‹œí•©ë‹ˆë‹¤!',
                    points: 20
                },
                {
                    id: 'q3',
                    question: 'í”„ë¡¬í”„íŠ¸ê°€ ì¤‘ìš”í•œ ì´ìœ ëŠ”?',
                    options: [
                        { id: 'a', text: 'AIì˜ í•™ìŠµ ì†ë„ë¥¼ ë†’ì—¬ì£¼ê¸° ë•Œë¬¸', correct: false },
                        { id: 'b', text: 'í”„ë¡¬í”„íŠ¸ì— ë”°ë¼ AIì˜ ë‹µë³€ì´ ë‹¬ë¼ì§€ê¸° ë•Œë¬¸', correct: true },
                        { id: 'c', text: 'AIë¥¼ ë” ë¹ ë¥´ê²Œ ë§Œë“¤ê¸° ë•Œë¬¸', correct: false },
                        { id: 'd', text: 'AIì˜ ë©”ëª¨ë¦¬ë¥¼ ì ˆì•½í•˜ê¸° ë•Œë¬¸', correct: false }
                    ],
                    explanation: 'ê°™ì€ AIë¼ë„ í”„ë¡¬í”„íŠ¸ê°€ ë‹¤ë¥´ë©´ ì™„ì „íˆ ë‹¤ë¥¸ ê²°ê³¼ë¥¼ ë§Œë“­ë‹ˆë‹¤. í”„ë¡¬í”„íŠ¸ëŠ” AIì™€ ëŒ€í™”í•˜ëŠ” ì–¸ì–´ì˜ˆìš”!',
                    points: 20
                },
                {
                    id: 'q4',
                    question: 'ì¢‹ì€ í”„ë¡¬í”„íŠ¸ì˜ ì¡°ê±´ì´ ì•„ë‹Œ ê²ƒì€?',
                    options: [
                        { id: 'a', text: 'ëª…í™•í•˜ê³  êµ¬ì²´ì ì´ì–´ì•¼ í•œë‹¤', correct: false },
                        { id: 'b', text: 'ì›í•˜ëŠ” ê²°ê³¼ì˜ í˜•ì‹ì„ ì§€ì •í•œë‹¤', correct: false },
                        { id: 'c', text: 'ê°€ëŠ¥í•œ í•œ ì§§ê³  ê°„ë‹¨í•´ì•¼ í•œë‹¤', correct: true },
                        { id: 'd', text: 'í•„ìš”í•œ ì¡°ê±´ê³¼ ì œì•½ì„ ëª…ì‹œí•œë‹¤', correct: false }
                    ],
                    explanation: 'í”„ë¡¬í”„íŠ¸ëŠ” ì§§ì€ ê²ƒë³´ë‹¤ ëª…í™•í•˜ê³  êµ¬ì²´ì ì¸ ê²ƒì´ ì¤‘ìš”í•©ë‹ˆë‹¤. í•„ìš”í•œ ì •ë³´ëŠ” ì¶©ë¶„íˆ ì œê³µí•´ì•¼ í•´ìš”!',
                    points: 20
                },
                {
                    id: 'q5',
                    question: 'AIì˜ ë‹µë³€ì´ ë§ˆìŒì— ë“¤ì§€ ì•Šì„ ë•Œ ê°€ì¥ ì ì ˆí•œ í–‰ë™ì€?',
                    options: [
                        { id: 'a', text: 'í¬ê¸°í•˜ê³  ë‹¤ë¥¸ ì¼ì„ í•œë‹¤', correct: false },
                        { id: 'b', text: 'ê°™ì€ ì§ˆë¬¸ì„ ë°˜ë³µí•œë‹¤', correct: false },
                        { id: 'c', text: 'í”„ë¡¬í”„íŠ¸ë¥¼ ë” êµ¬ì²´ì ìœ¼ë¡œ ìˆ˜ì •í•´ì„œ ë‹¤ì‹œ ì§ˆë¬¸í•œë‹¤', correct: true },
                        { id: 'd', text: 'AIê°€ ì˜ëª»ëë‹¤ê³  ìƒê°í•œë‹¤', correct: false }
                    ],
                    explanation: 'AIëŠ” ìš°ë¦¬ê°€ ì£¼ëŠ” ì§€ì‹œë¥¼ ë”°ë¥¼ ë¿ì…ë‹ˆë‹¤. ë‹µë³€ì´ ë¶€ì¡±í•˜ë‹¤ë©´ í”„ë¡¬í”„íŠ¸ë¥¼ ê°œì„ í•´ì•¼ í•´ìš”!',
                    points: 20
                }
            ];

            const currentQ = questions[currentQuestion];

            const handleAnswer = (optionId) => {
                if (showFeedback) return;
                setSelectedAnswer(optionId);
                setShowFeedback(true);

                const option = currentQ.options.find(o => o.id === optionId);
                if (option.correct) {
                    updateScore(currentQ.points);
                    setEarnedScore(prev => prev + currentQ.points);
                }
            };

            const handleNext = () => {
                if (currentQuestion < questions.length - 1) {
                    setCurrentQuestion(currentQuestion + 1);
                    setSelectedAnswer(null);
                    setShowFeedback(false);
                } else {
                    markStageComplete('stage4');
                    goToStage(5);
                }
            };

            const selectedOption = currentQ.options.find(o => o.id === selectedAnswer);

            return (
                <div className="bg-white rounded-3xl shadow-2xl p-8 md:p-12 fade-in">
                    <div className="text-center mb-8">
                        <div className="text-6xl mb-6 bounce">âœï¸</div>
                        <h2 className="text-3xl font-bold text-gray-800 mb-4">4ë‹¨ê³„: ë¬¸ì œ í’€ì´</h2>
                        <div className="flex justify-center gap-2 mb-4">
                            {questions.map((_, idx) => (
                                <div key={idx} className={`w-3 h-3 rounded-full ${idx === currentQuestion ? 'bg-purple-500' : idx < currentQuestion ? 'bg-green-500' : 'bg-gray-300'}`} />
                            ))}
                        </div>
                        <p className="text-gray-600">ë¬¸ì œ {currentQuestion + 1} / {questions.length}</p>
                        <div className="mt-4 inline-block bg-purple-100 px-4 py-2 rounded-full">
                            <p className="text-purple-800 font-bold">íšë“ ì ìˆ˜: {earnedScore}ì  / {MAX_SCORE}ì </p>
                        </div>
                    </div>

                    <div className="bg-gradient-to-br from-blue-50 to-purple-50 rounded-2xl p-6 mb-6 border-2 border-blue-200">
                        <h3 className="text-xl font-bold text-gray-800 mb-6">{currentQ.question}</h3>
                        <div className="space-y-3">
                            {currentQ.options.map((option) => (
                                <button
                                    key={option.id}
                                    onClick={() => handleAnswer(option.id)}
                                    disabled={showFeedback}
                                    className={`w-full text-left p-4 rounded-xl border-2 transition-all ${
                                        showFeedback
                                            ? option.correct
                                                ? 'bg-green-100 border-green-500'
                                                : option.id === selectedAnswer
                                                ? 'bg-red-100 border-red-500'
                                                : 'bg-gray-50 border-gray-300'
                                            : selectedAnswer === option.id
                                            ? 'bg-blue-100 border-blue-500'
                                            : 'bg-white border-gray-300 hover:border-blue-400 hover:bg-blue-50'
                                    }`}>
                                    <div className="flex items-center">
                                        <div className={`w-8 h-8 rounded-full border-2 flex items-center justify-center mr-4 font-bold ${
                                            showFeedback && option.correct
                                                ? 'bg-green-500 border-green-500 text-white'
                                                : showFeedback && option.id === selectedAnswer
                                                ? 'bg-red-500 border-red-500 text-white'
                                                : 'border-gray-400 text-gray-600'
                                        }`}>
                                            {showFeedback && option.correct ? 'âœ“' : showFeedback && option.id === selectedAnswer ? 'âœ—' : option.id.toUpperCase()}
                                        </div>
                                        <span className="flex-1 font-medium">{option.text}</span>
                                    </div>
                                </button>
                            ))}
                        </div>
                    </div>

                    {showFeedback && (
                        <div className={`rounded-2xl p-6 mb-6 border-2 fade-in ${
                            selectedOption?.correct 
                                ? 'bg-green-50 border-green-300' 
                                : 'bg-red-50 border-red-300'
                        }`}>
                            <div className="flex items-start mb-4">
                                <div className="text-4xl mr-4">{selectedOption?.correct ? 'ğŸ‰' : 'ğŸ’¡'}</div>
                                <div className="flex-1">
                                    <h4 className={`text-xl font-bold mb-2 ${selectedOption?.correct ? 'text-green-800' : 'text-red-800'}`}>
                                        {selectedOption?.correct ? `ì •ë‹µì…ë‹ˆë‹¤! +${currentQ.points}ì ` : 'ì•„ì‰½ì§€ë§Œ ë‹¤ì‹œ ìƒê°í•´ë³¼ê¹Œìš”?'}
                                    </h4>
                                    <p className="text-gray-700 mb-3">{currentQ.explanation}</p>
                                </div>
                            </div>
                        </div>
                    )}

                    {showFeedback && (
                        <button onClick={handleNext}
                            className="w-full bg-gradient-to-r from-blue-600 to-purple-600 text-white text-xl font-bold py-5 px-8 rounded-2xl hover:shadow-2xl transform hover:scale-105 transition-all">
                            {currentQuestion < questions.length - 1 ? 'ë‹¤ìŒ ë¬¸ì œ âœ' : 'ê²°ê³¼ í™•ì¸ âœ'}
                        </button>
                    )}
                </div>
            );
        }

        function Stage5({ totalScore, setAllStagesCompleted }) {
            const certRef = useRef(null);
            const [checkedItems, setCheckedItems] = useState({});

            const keyLearnings = [
                {
                    id: 'l1',
                    title: 'í”„ë¡¬í”„íŠ¸ì˜ ê°œë…',
                    desc: 'AIì—ê²Œ ì£¼ëŠ” ëª…ë ¹ë¬¸ì´ë‚˜ ì§ˆë¬¸ì„ "í”„ë¡¬í”„íŠ¸"ë¼ê³  í•©ë‹ˆë‹¤. í”„ë¡¬í”„íŠ¸ëŠ” AIì™€ ëŒ€í™”í•˜ëŠ” ì–¸ì–´ì…ë‹ˆë‹¤.'
                },
                {
                    id: 'l2',
                    title: 'ëª…í™•ì„±ì˜ ì¤‘ìš”ì„±',
                    desc: 'í”„ë¡¬í”„íŠ¸ê°€ ëª…í™•í• ìˆ˜ë¡ AIì˜ ë‹µë³€ë„ ì •í™•í•´ì§‘ë‹ˆë‹¤. ëª¨í˜¸í•œ ì§ˆë¬¸ì€ ëª¨í˜¸í•œ ë‹µë³€ì„ ë§Œë“­ë‹ˆë‹¤.'
                },
                {
                    id: 'l3',
                    title: 'êµ¬ì²´ì„±ì˜ í˜',
                    desc: 'êµ¬ì²´ì ì¸ ì¡°ê±´(ì‹œê°„, ëŒ€ìƒ, ë°©ë²•, ìŠ¤íƒ€ì¼ ë“±)ì„ ëª…ì‹œí•˜ë©´ ë” ë§ì¶¤í™”ëœ ê²°ê³¼ë¥¼ ì–»ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.'
                },
                {
                    id: 'l4',
                    title: 'ì§€ì†ì  ê°œì„ ',
                    desc: 'AIì˜ ë‹µë³€ì´ ë§ˆìŒì— ë“¤ì§€ ì•Šìœ¼ë©´ í”„ë¡¬í”„íŠ¸ë¥¼ ìˆ˜ì •í•˜ì„¸ìš”. í”„ë¡¬í”„íŠ¸ ì—”ì§€ë‹ˆì–´ë§ì€ ì‹œí–‰ì°©ì˜¤ë¥¼ í†µí•´ ë°œì „í•©ë‹ˆë‹¤.'
                }
            ];

            const handleCheckItem = (id) => {
                setCheckedItems(prev => ({ ...prev, [id]: !prev[id] }));
            };

            const allChecked = Object.keys(checkedItems).length === keyLearnings.length && Object.values(checkedItems).every(v => v);

            useEffect(() => {
                if (allChecked) { setAllStagesCompleted(true); }
            }, [allChecked, setAllStagesCompleted]);

            let level = '', emoji = '', rank = '', comment = '';
            if (totalScore >= 80) { level = 'í”„ë¡¬í”„íŠ¸ ë§ˆìŠ¤í„°'; emoji = 'ğŸ†'; rank = 'MASTER'; comment = 'ìµœê³ ì˜ ì‹¤ë ¥!'; }
            else if (totalScore >= 60) { level = 'í”„ë¡¬í”„íŠ¸ ì „ë¬¸ê°€'; emoji = 'ğŸ“'; rank = 'EXPERT'; comment = 'ìš°ìˆ˜í•œ ì´í•´ë„!'; }
            else { level = 'í”„ë¡¬í”„íŠ¸ í•™ìŠµì'; emoji = 'ğŸŒ±'; rank = 'BEGINNER'; comment = 'ì¢‹ì€ ì‹œì‘!'; }

            const downloadCert = () => {
                html2canvas(certRef.current, { scale: 2, backgroundColor: '#ffffff' }).then(canvas => {
                    const link = document.createElement('a');
                    link.download = 'í”„ë¡¬í”„íŠ¸ì‹¤í—˜ì‹¤_ì¸ì¦ì„œ.png';
                    link.href = canvas.toDataURL();
                    link.click();
                });
            };

            return (
                <div className="bg-white rounded-3xl shadow-2xl p-8 md:p-12 fade-in">
                    <div className="text-center mb-8">
                        <div className="text-7xl mb-6 bounce">ğŸ“</div>
                        <h2 className="text-4xl font-bold text-gray-800 mb-6">ì‹¤í—˜ ì™„ë£Œ!</h2>
                    </div>

                    <div className="bg-gradient-to-br from-purple-50 to-pink-50 rounded-3xl p-8 text-left border-2 border-purple-200 mb-6">
                        <h3 className="text-2xl font-bold text-purple-800 mb-4 text-center">ğŸ“š ì¢‹ì€ í”„ë¡¬í”„íŠ¸ì˜ ì¡°ê±´</h3>
                        <p className="text-center text-gray-600 mb-6">ê° í•­ëª©ì„ í™•ì¸í•˜ë©° ì²´í¬í•´ë³´ì„¸ìš”!</p>
                        <div className="space-y-4">
                            {keyLearnings.map(item => (
                                <div key={item.id} onClick={() => handleCheckItem(item.id)}
                                    className={`bg-white rounded-xl p-5 flex items-start cursor-pointer transition-all duration-300 border-2 ${
                                        checkedItems[item.id] ? 'bg-green-50 border-green-300' : 'border-gray-200 hover:border-purple-300'
                                    }`}>
                                    <div className={`w-8 h-8 rounded-lg border-2 mr-4 flex items-center justify-center flex-shrink-0 transition-all ${
                                        checkedItems[item.id] ? 'bg-green-500 border-green-500' : 'bg-white border-gray-400'
                                    }`}>
                                        {checkedItems[item.id] && <span className="text-white text-xl font-bold">âœ“</span>}
                                    </div>
                                    <div className="flex-1">
                                        <h4 className="font-bold text-lg text-gray-800 mb-1">{item.title}</h4>
                                        <p className="text-gray-700">{item.desc}</p>
                                    </div>
                                </div>
                            ))}
                        </div>
                        {allChecked && (
                            <div className="mt-6 bg-green-100 border-2 border-green-400 rounded-xl p-4 text-center fade-in">
                                <p className="text-green-800 font-bold text-lg">ğŸ‰ ëª¨ë“  í•µì‹¬ ë‚´ìš©ì„ í™•ì¸í–ˆì–´ìš”!</p>
                            </div>
                        )}
                    </div>

                    <div ref={certRef} className="bg-gradient-to-br from-blue-50 via-white to-purple-50 rounded-3xl p-10 mb-8 border-4 border-blue-300 shadow-2xl">
                        <div className="text-6xl mb-4">{emoji}</div>
                        <h3 className="text-3xl font-bold text-blue-800 mb-4">í”„ë¡¬í”„íŠ¸ ì‹¤í—˜ì‹¤ ì¸ì¦ì„œ</h3>
                        <div className="bg-white bg-opacity-60 rounded-2xl p-8">
                            <p className="text-gray-700 text-lg mb-6">ì´ ì¸ì¦ì„œëŠ” ë‹¤ìŒ ì‚¬ëŒì´</p>
                            <div className="bg-yellow-100 border-2 border-yellow-400 rounded-xl p-4 mb-6">
                                <input type="text" placeholder="ì—¬ê¸°ì— ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”" className="text-2xl font-bold text-center w-full bg-transparent border-none outline-none" />
                            </div>
                            <p className="text-gray-700 text-lg mb-4">í”„ë¡¬í”„íŠ¸ì˜ ê°œë…ê³¼ í™œìš©ë²•ì„<br/>ì„±ê³µì ìœ¼ë¡œ í•™ìŠµí–ˆìŒì„ ì¦ëª…í•©ë‹ˆë‹¤.</p>
                            <div className="bg-gradient-to-r from-blue-100 to-purple-100 rounded-xl p-6 mb-4">
                                <div className="text-sm text-gray-600 mb-2">ìµœì¢… ì ìˆ˜</div>
                                <div className="text-5xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent">{totalScore}ì </div>
                                <div className="text-sm text-gray-600 mt-1">/ {MAX_SCORE}ì </div>
                            </div>
                            <div className="bg-yellow-50 border-2 border-yellow-300 rounded-xl p-4">
                                <div className="text-sm text-yellow-800 mb-1">ì‹¤í—˜ì ë ˆë²¨</div>
                                <div className="text-3xl font-bold text-yellow-700 mb-1">{level}</div>
                                <div className="inline-block bg-yellow-200 px-3 py-1 rounded-full text-xs font-bold text-yellow-800 mb-2">{rank}</div>
                                <div className="text-sm text-yellow-700">{comment}</div>
                            </div>
                        </div>
                        <p className="text-gray-500 text-sm mt-4">{new Date().toLocaleDateString('ko-KR')}</p>
                    </div>

                    <div className="bg-gradient-to-r from-green-50 to-emerald-50 rounded-2xl p-6 mb-6 border-2 border-green-200">
                        <h3 className="text-xl font-bold text-green-800 mb-4">ğŸ… ë ˆë²¨ ê¸°ì¤€</h3>
                        <div className="grid md:grid-cols-3 gap-4 text-left">
                            {[
                                { e: 'ğŸ†', n: 'í”„ë¡¬í”„íŠ¸ ë§ˆìŠ¤í„°', r: 'MASTER', s: '80ì  ì´ìƒ', h: totalScore >= 80 },
                                { e: 'ğŸ“', n: 'í”„ë¡¬í”„íŠ¸ ì „ë¬¸ê°€', r: 'EXPERT', s: '60-79ì ', h: totalScore >= 60 && totalScore < 80 },
                                { e: 'ğŸŒ±', n: 'í”„ë¡¬í”„íŠ¸ í•™ìŠµì', r: 'BEGINNER', s: '59ì  ì´í•˜', h: totalScore < 60 }
                            ].map((l, i) => (
                                <div key={i} className={`bg-white rounded-xl p-4 border-2 ${l.h ? 'border-green-400 shadow-lg' : 'border-gray-200'}`}>
                                    <div className="text-3xl mb-2">{l.e}</div>
                                    <div className="font-bold text-gray-800 mb-1">{l.n}</div>
                                    <div className="text-sm font-bold mb-2" style={{color: i === 0 ? '#059669' : i === 1 ? '#3b82f6' : '#f59e0b'}}>{l.r}</div>
                                    <div className="text-xs text-gray-600">{l.s}</div>
                                </div>
                            ))}
                        </div>
                    </div>

                    <button onClick={downloadCert} className="w-full bg-gradient-to-r from-green-600 to-emerald-600 text-white text-xl font-bold py-5 px-8 rounded-2xl hover:shadow-2xl transform hover:scale-105 transition-all">
                        ğŸ“¥ ì¸ì¦ì„œ ë‹¤ìš´ë¡œë“œí•˜ê¸°
                    </button>
                </div>
            );
        }

        ReactDOM.createRoot(document.getElementById('root')).render(<PromptLab />);
    </script>
</body>
</html>
